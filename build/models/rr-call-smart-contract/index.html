
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.4.2">
    
    
      
        <title>Round Robin Task Allocation smart contract - Task Allocation Prototype Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.69437709.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/styles.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-green" data-md-color-accent="pink">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#round-robin-task-allocation-smart-contract" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Task Allocation Prototype Documentation" class="md-header__button md-logo" aria-label="Task Allocation Prototype Documentation" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Task Allocation Prototype Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Round Robin Task Allocation smart contract
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="light-green" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="light-green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/P2PModels/task-allocation-prototype" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Task Allocation
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Task Allocation Prototype Documentation" class="md-nav__button md-logo" aria-label="Task Allocation Prototype Documentation" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    Task Allocation Prototype Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/P2PModels/task-allocation-prototype" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Task Allocation
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../roadmap/" class="md-nav__link">
        Roadmap
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Models" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          First Come First Serve
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="First Come First Serve" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          First Come First Serve
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fcfs-model/" class="md-nav__link">
        Description
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fcfs-smart-contract/" class="md-nav__link">
        Smart contract
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fcfs-subgraph/" class="md-nav__link">
        Subgraph
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          Round Robin
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Round Robin" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Round Robin
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rr-model/" class="md-nav__link">
        Description
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rr-smart-contract/" class="md-nav__link">
        Smart contract
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rr-subgraph/" class="md-nav__link">
        Subgraph
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3">
          Round Robin with calendar
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Round Robin with calendar" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Round Robin with calendar
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rr-cal-model/" class="md-nav__link">
        Description
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rr-cal-smart-contract.md" class="md-nav__link">
        Smart contract
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rr-cal-subgraph/" class="md-nav__link">
        Subgraph
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../metadocs/" class="md-nav__link">
        MetaDocs
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#types" class="md-nav__link">
    Types
  </a>
  
    <nav class="md-nav" aria-label="Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task" class="md-nav__link">
    Task
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user" class="md-nav__link">
    User
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#events" class="md-nav__link">
    Events
  </a>
  
    <nav class="md-nav" aria-label="Events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task-created" class="md-nav__link">
    Task created
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-deleted" class="md-nav__link">
    Task deleted
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-accepted" class="md-nav__link">
    Task accepted
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-rejected" class="md-nav__link">
    Task rejected
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-allocated" class="md-nav__link">
    Task allocated
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-registered" class="md-nav__link">
    User registered
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-deleted" class="md-nav__link">
    User deleted
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rejecter-deleted" class="md-nav__link">
    Rejecter deleted
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modifiers" class="md-nav__link">
    Modifiers
  </a>
  
    <nav class="md-nav" aria-label="Modifiers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#userhasnotask" class="md-nav__link">
    userHasNoTask
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#userdontexist" class="md-nav__link">
    userDontExist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#userexists" class="md-nav__link">
    userExists
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#taskdontexist" class="md-nav__link">
    taskDontExist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#taskexists" class="md-nav__link">
    taskExists
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#taskassigned" class="md-nav__link">
    taskAssigned
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toomanytasks" class="md-nav__link">
    tooManyTasks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#restart" class="md-nav__link">
    Restart
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register-user" class="md-nav__link">
    Register user
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-task" class="md-nav__link">
    Create task
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accept-task" class="md-nav__link">
    Accept task
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allocate-task" class="md-nav__link">
    Allocate task
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reallocate-task" class="md-nav__link">
    Reallocate task
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reject-task" class="md-nav__link">
    Reject task
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-user-allocated-task" class="md-nav__link">
    Add user allocated task
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#errors" class="md-nav__link">
    Errors
  </a>
  
    <nav class="md-nav" aria-label="Errors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user_has_task" class="md-nav__link">
    USER_HAS_TASK
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user_already_exists" class="md-nav__link">
    USER_ALREADY_EXISTS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user_dont_exist" class="md-nav__link">
    USER_DONT_EXIST
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user_has_too_many_tasks" class="md-nav__link">
    USER_HAS_TOO_MANY_TASKS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task_exists" class="md-nav__link">
    TASK_EXISTS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task_dont_exist" class="md-nav__link">
    TASK_DONT_EXIST
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task_allocation_fail" class="md-nav__link">
    TASK_ALLOCATION_FAIL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task_not_available" class="md-nav__link">
    TASK_NOT_AVAILABLE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task_not_assigned_to_user" class="md-nav__link">
    TASK_NOT_ASSIGNED_TO_USER
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/P2PModels/task-allocation-prototype/edit/master/docs/models/rr-call-smart-contract.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="round-robin-task-allocation-smart-contract">Round Robin Task Allocation smart contract<a class="headerlink" href="#round-robin-task-allocation-smart-contract" title="Permanent link">&para;</a></h1>
<p>This smart contract implements the logic behind the Round Robin algorithm. In order to do that it uses the following set of types, variables, events, modifiers, methods and errors:</p>
<h2 id="types">Types<a class="headerlink" href="#types" title="Permanent link">&para;</a></h2>
<h3 id="task">Task<a class="headerlink" href="#task" title="Permanent link">&para;</a></h3>
<pre><code>    struct Task {
        uint256 userIndex;
        uint256 allocationIndex;
        uint256 endDate;
        Status status;
        mapping(bytes32 =&gt; bool) rejecters;
        uint256 reallocationTime;
    }
</code></pre>
<ul>
<li><em>allocationIndex</em>: needed to remove task when being reallocated.</li>
<li><em>endDate</em>: timestamp <strong>in s</strong> (when working with it in js remember to multiply by 1000!) of the task deadline.</li>
<li><em>status</em>: the current status of the task.</li>
<li><em>rejecters</em>: list of users who rejected the task.</li>
<li><em>reallocationTime</em>: the period of time <strong>in s</strong> in which the task has to be reallocated.</li>
</ul>
<h3 id="user">User<a class="headerlink" href="#user" title="Permanent link">&para;</a></h3>
<pre><code>struct User {
        uint256 index;
        uint256 benefits;
        bool available;
        bool exists;
        mapping(uint256 =&gt; bytes32) allocatedTasks;
        uint256 allocatedTasksLength;
    }
</code></pre>
<ul>
<li><em>benefits</em>: in the future could taken into account by the algorithm, currently not used.</li>
<li><em>available</em>: whether the user is available (no task accepted) or bussy (task accepted).</li>
<li><em>exists</em>: check if the user exists in the mapping.</li>
<li><em>allocatedTasks</em>: list of tasks assigned to the user.</li>
<li><em>allocatedTasksLength</em>: length of the allocatedTask list.</li>
</ul>
<h2 id="events">Events<a class="headerlink" href="#events" title="Permanent link">&para;</a></h2>
<h3 id="task-created">Task created<a class="headerlink" href="#task-created" title="Permanent link">&para;</a></h3>
<pre><code>TaskCreated(bytes32 indexed taskId)
</code></pre>
<h3 id="task-deleted">Task deleted<a class="headerlink" href="#task-deleted" title="Permanent link">&para;</a></h3>
<pre><code>TaskDeleted(bytes32 indexed taskId)
</code></pre>
<h3 id="task-accepted">Task accepted<a class="headerlink" href="#task-accepted" title="Permanent link">&para;</a></h3>
<pre><code>TaskAccepted(bytes32 indexed userId, bytes32 indexed taskId)
</code></pre>
<h3 id="task-rejected">Task rejected<a class="headerlink" href="#task-rejected" title="Permanent link">&para;</a></h3>
<pre><code>TaskRejected(bytes32 indexed userId, bytes32 indexed taskId)
</code></pre>
<h3 id="task-allocated">Task allocated<a class="headerlink" href="#task-allocated" title="Permanent link">&para;</a></h3>
<pre><code>TaskAllocated(bytes32 indexed userId, bytes32 indexed taskId, bytes32 previousUserId)
</code></pre>
<h3 id="user-registered">User registered<a class="headerlink" href="#user-registered" title="Permanent link">&para;</a></h3>
<pre><code>UserRegistered(bytes32 indexed userId)
</code></pre>
<h3 id="user-deleted">User deleted<a class="headerlink" href="#user-deleted" title="Permanent link">&para;</a></h3>
<pre><code>UserDeleted(bytes32 indexed userId)
</code></pre>
<h3 id="rejecter-deleted">Rejecter deleted<a class="headerlink" href="#rejecter-deleted" title="Permanent link">&para;</a></h3>
<pre><code>RejecterDeleted(bytes32 indexed userId, bytes32 indexed taskId)
</code></pre>
<h2 id="modifiers">Modifiers<a class="headerlink" href="#modifiers" title="Permanent link">&para;</a></h2>
<h3 id="userhasnotask">userHasNoTask<a class="headerlink" href="#userhasnotask" title="Permanent link">&para;</a></h3>
<pre><code> userHasNoTask(bytes32 _userId)
</code></pre>
<p>Checks that the user doesn't have a task assigned.</p>
<h3 id="userdontexist">userDontExist<a class="headerlink" href="#userdontexist" title="Permanent link">&para;</a></h3>
<pre><code> userDontExist(bytes32 _userId)
</code></pre>
<p>Checks that the user doesn't exists.</p>
<h3 id="userexists">userExists<a class="headerlink" href="#userexists" title="Permanent link">&para;</a></h3>
<pre><code> userExists(bytes32 _userId)
</code></pre>
<p>Checks that the user exists.</p>
<h3 id="taskdontexist">taskDontExist<a class="headerlink" href="#taskdontexist" title="Permanent link">&para;</a></h3>
<pre><code> taskDontExist(bytes32 _taskId)
</code></pre>
<p>Checks that the task doesn't exist.</p>
<h3 id="taskexists">taskExists<a class="headerlink" href="#taskexists" title="Permanent link">&para;</a></h3>
<pre><code> taskExists(bytes32 _taskId)
</code></pre>
<p>Checks that the task exists.</p>
<h3 id="taskassigned">taskAssigned<a class="headerlink" href="#taskassigned" title="Permanent link">&para;</a></h3>
<pre><code> taskAssigned(bytes32 _taskId, bytes32 _userId)
</code></pre>
<p>Checks that the task is been assigned.</p>
<h3 id="toomanytasks">tooManyTasks<a class="headerlink" href="#toomanytasks" title="Permanent link">&para;</a></h3>
<pre><code> tooManyTasks(bytes32 _userId)
</code></pre>
<p>Checks if the user exceeds the max number of assigned tasks.</p>
<h2 id="methods">Methods<a class="headerlink" href="#methods" title="Permanent link">&para;</a></h2>
<h3 id="restart">Restart<a class="headerlink" href="#restart" title="Permanent link">&para;</a></h3>
<p>restart() &rarr; <em>void</em></p>
<div class="badge-container">
    <div class="badge badge-override">override</div>
    <div class="badge badge-external">external</div>
</div>

<p>Function used to clean up the contract. Removes tasks, resets task status, removes users and user index.</p>
<p>Events:</p>
<ul>
<li>TaskDeleted(_taskId)</li>
<li>UserDeleted(_userId)</li>
<li>TasksRestart(msg.sender)</li>
</ul>
<h3 id="register-user">Register user<a class="headerlink" href="#register-user" title="Permanent link">&para;</a></h3>
<p>registerUser(bytes32 _userId) &rarr; <em>void</em></p>
<div class="badge-container">
    <div class="badge badge-external">external</div>
</div>

<p>Registers an empty user given an ID.</p>
<p>Modifiers:</p>
<ul>
<li>userDontExist(_userId)</li>
</ul>
<p>Events:</p>
<ul>
<li>UserRegistered(_userId)</li>
</ul>
<h3 id="create-task">Create task<a class="headerlink" href="#create-task" title="Permanent link">&para;</a></h3>
<p>createTask(bytes32 _taskId, uint256 reallocationTime) &rarr; <em>void</em></p>
<div class="badge-container">
    <div class="badge badge-external">external</div>
</div>

<p>Creates an empty task given an ID.</p>
<p>Modifiers:</p>
<ul>
<li>taskDontExist(_taskId)</li>
</ul>
<p>Events:</p>
<ul>
<li>TaskCreated(_taskId)</li>
</ul>
<h3 id="accept-task">Accept task<a class="headerlink" href="#accept-task" title="Permanent link">&para;</a></h3>
<p>acceptTask(bytes32 _userId, bytes32 _taskId) &rarr; <em>void</em></p>
<div class="badge-container">
    <div class="badge badge-external">external</div>
</div>

<p>Function called when a user accepts a task</p>
<p>Modifiers:</p>
<ul>
<li>userExists(_userId)</li>
<li>taskAssigned(_taskId, _userId)</li>
<li>userHasNoTask(_userId)</li>
</ul>
<p>Events:</p>
<ul>
<li>TaskAccepted(_taskId)</li>
</ul>
<h3 id="allocate-task">Allocate task<a class="headerlink" href="#allocate-task" title="Permanent link">&para;</a></h3>
<p>allocateTask(bytes32 _taskId, bytes32 _userId) &rarr; <em>void</em></p>
<div class="badge-container">
    <div class="badge badge-external">external</div>
</div>

<p>Calls the function that assigns a task to a user</p>
<p>Modifiers:</p>
<ul>
<li>taskExists(_taskId)</li>
<li>userExists(_userId)</li>
</ul>
<p>Events:</p>
<ul>
<li>TaskAllocated(_userId, _taskId, oldUserId)</li>
</ul>
<h3 id="reallocate-task">Reallocate task<a class="headerlink" href="#reallocate-task" title="Permanent link">&para;</a></h3>
<p>reallocateTask(bytes32 _taskId) &rarr; <em>void</em></p>
<div class="badge-container">
    <div class="badge badge-public">public</div>
</div>

<p>Fucntion that implements the round-robin algorithm:</p>
<pre><code>  - Delete task from the previous "owner"
  - Iterate until find a user to whom assign the task or the array of users was totally traversed
      - Check if index arrives to the end of the round then it should start over
      - Try to assigned that task to user (currUserId)
      - If assignation was successful emit event TaskAllocated
      - If assignation did not work, increase counters to continue with the round robin
  - Assign rejected status to the task if it couldn't be assigned to a user
</code></pre>
<p>Fisrt the algorithm loads the current task, which contains the previously assigned user (by index).
Then loads the old user ID, generates de new user index (adding one to the old one), sets a flag for founded asignee and sets a counter to 0.</p>
<p>Then the algorithm starts a while loop to traverse all the users while no asignee is founded.
Inside the loop it first checks that the index it's within range, if greater is restarted.
Then it gets the user ID by index.
Trys to assign the task to the user. (The task is assigned if the user is available, she doesn't have the task already, doesn't have max number of tasks and she hasn't rejected it)
Checks if it worked, if not the user counter adds one aswell as the new user index.</p>
<p>If the loop fails to find an asignee, the task status is set to rejected.</p>
<p>Modifiers:</p>
<ul>
<li>taskExists(_taskId)</li>
</ul>
<p>Events: </p>
<ul>
<li>TaskAllocated(_userId, _taskId, oldUserId)</li>
</ul>
<h3 id="reject-task">Reject task<a class="headerlink" href="#reject-task" title="Permanent link">&para;</a></h3>
<p>rejectTask(bytes32 _userId, bytes32 _taskId) &rarr; <em>void</em></p>
<div class="badge-container">
    <div class="badge badge-external">external</div>
</div>

<p>Function used when a user rejects a task</p>
<p>Modifiers:</p>
<ul>
<li>userExists(_userId)</li>
<li>taskAssigned(_taskId, _userId)</li>
</ul>
<p>Events: </p>
<ul>
<li>TaskRejected(_userId, _taskId)</li>
</ul>
<h3 id="add-user-allocated-task">Add user allocated task<a class="headerlink" href="#add-user-allocated-task" title="Permanent link">&para;</a></h3>
<p>addUserAllocatedTask(bytes32 <em>userId, bytes32 _taskId)  &rarr; _bool</em></p>
<div class="badge-container">
    <div class="badge badge-private">private</div>
</div>

<pre><code>
</code></pre>
<p>Function used to assign a task to a user</p>
<ul>
<li><strong>deleteUserAllocatedTask</strong>(</li>
<li><strong>getUser</strong>(</li>
<li><strong>getAllocatedTask</strong>(</li>
<li><strong>getTask(bytes32 _taskId)</strong></li>
<li><strong>getRejecter</strong>(bytes32 _taskId, bytes32 _userId)</li>
<li><strong>getUserLength</strong>()</li>
</ul>
<h2 id="errors">Errors<a class="headerlink" href="#errors" title="Permanent link">&para;</a></h2>
<h4 id="user_has_task">USER_HAS_TASK<a class="headerlink" href="#user_has_task" title="Permanent link">&para;</a></h4>
<h4 id="user_already_exists">USER_ALREADY_EXISTS<a class="headerlink" href="#user_already_exists" title="Permanent link">&para;</a></h4>
<h4 id="user_dont_exist">USER_DONT_EXIST<a class="headerlink" href="#user_dont_exist" title="Permanent link">&para;</a></h4>
<h4 id="user_has_too_many_tasks">USER_HAS_TOO_MANY_TASKS<a class="headerlink" href="#user_has_too_many_tasks" title="Permanent link">&para;</a></h4>
<h4 id="task_exists">TASK_EXISTS<a class="headerlink" href="#task_exists" title="Permanent link">&para;</a></h4>
<h4 id="task_dont_exist">TASK_DONT_EXIST<a class="headerlink" href="#task_dont_exist" title="Permanent link">&para;</a></h4>
<h4 id="task_allocation_fail">TASK_ALLOCATION_FAIL<a class="headerlink" href="#task_allocation_fail" title="Permanent link">&para;</a></h4>
<h4 id="task_not_available">TASK_NOT_AVAILABLE<a class="headerlink" href="#task_not_available" title="Permanent link">&para;</a></h4>
<h4 id="task_not_assigned_to_user">TASK_NOT_ASSIGNED_TO_USER<a class="headerlink" href="#task_not_assigned_to_user" title="Permanent link">&para;</a></h4>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      2022-11-29
    
  </small>
</div>




              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://p2pmodels.eu" target="_blank" rel="noopener" title="P2PModels website" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M23.19 32c5.67 0 11.15 2.08 15.4 5.86L312.6 281.4c4.7 4.2 7.4 10.2 7.4 16.5 0 12.2-9.9 22.1-22.1 22.1H179.8l56.8 113.7c7.9 15.8 1.5 35-14.3 42.9-15.8 7.9-35 1.5-42.9-14.3L121.2 346l-82.62 94.5c-4.18 4.8-10.22 7.5-16.57 7.5C9.855 448 0 438.1 0 425.1V55.18C0 42.38 10.38 32 23.18 32h.01z"/></svg>
    </a>
  
    
    
    <a href="https://twitter.com/p2pmod" target="_blank" rel="noopener" title="P2PModels on Twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    <a href="https://github.com/P2PModels" target="_blank" rel="noopener" title="P2PModels on Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.9c69f0bc.min.js"></script>
      
    
  </body>
</html>